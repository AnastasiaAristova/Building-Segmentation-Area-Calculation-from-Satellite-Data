# Building-Segmentation-Area-Calculation-from-Satellite-Data

В данном проекте решается задача семантической сегментации зданий на спутниковых снимках с последующим рассчетом площади застройки. 
Для обучения использовался датасет Inria Aerial Image Labeling. Описание датасета можно найти здесь - https://project.inria.fr/aerialimagelabeling/ .
Тестовый датасет был подготовлен с помощью Google Earth Engine (https://earthengine.google.com/). Инструкция по работе с Google Earth Engine - https://developers.google.com/earth-engine/guides/access. Разметка тестового датасета была выполнена вручную с помощью инструмента CVAT (https://www.cvat.ai/)/
В качестве архитектуры сети использовалась Unet - подобная архитектура. 
В качестве функции потерь использовалась Unified Focal Loss.
Для оценки модели использовались метрики: IoU, Dice, Precision, Recall.
Для инференса модели реализовано веб-приложение на основе Streamlit.
Структура репозитория:

.

├── notebooks/                                      # Jupyter ноутбуки

│   ├── Подготовка тренировочного датасета.ipynb    

│   ├── Подготовка тестового датасета.ipynb        

│   ├── Pipeline Lite.ipynb                         # Обучение модели на сокращенном датасете

│   ├── Pipeline Full.ipynb                         # Обучение модели на полном датасете

│   ├── Инференс модели.ipynb                       # Инференс модели

│   └── демо-приложение Streamlit.ipynb             # Запуск демо для Google Colab

├── streamlit_app/                                  # Streamlit приложение

│   ├── demo.py                                     # Основной скрипт

│   └── backbone.py                                 # Вспомогательные функции

├── model/                                          # Веса обученной модели

├── data/                                           # Примеры данных

└── README.md


В ноубтуке "Подготовка тренировочного датасета.ipynb" выполняется загрузка датасета с сайта и его подготовка для данного проекта. Готовый датасет сохраняется на Google-диск. Для использования замените указанные пути на свои.
В ноутбуке "Подготовка тестового датасета.ipynb" выполняется загрузка данных с Google Earth Engine и подготовка тестовго датасета. Готовый датасет сохраняется на Google-диск. Для использования замените указанные пути на свои. Полученные изображения размечались с помощью CVAT и затем полный датасет был загружен на Google-диск. 
В ноутбуке "Pipeline Lite.ipynb" реализован полный пайплайн обучения на неполном датасете. В нем реализованы подргузка датасета, архитектура модели, метрики и функции потерь, функции обучения и тестирования. Также ноубук сожержит обоснование выбора функции потерь и содержит несколько экспериментов с обучением.
В ноутбуке "Pipeline Full.ipynb" реализован полный пайплайн обучения на полном датасете с несколькими экпериментами и сравнениями разных вариантов обучения. 
В ноутбуке "Инференс модели.ipynb" выполнен инференс модели - сегментация изображения и подсчет площади застройки. Для работы необходимо загрузить веса модели best_iou.pt из папки model/ и примеры изображений из папки data/ данного репозитория к себе на Google-диск или в сессионное хранилище ноутбука и поменять пути. 
В ноутбуке "демо-приложение Streamlit.ipynb" реализован запуск демо-приложения с помощью Google Colab.
Также приложение пожно запустить с локального компьютера. Для этого необходимо сохранить папку streamlit_app/ со всеми файлами, установить необходимые зависимости и запустить команду: streamlit run streamlit_app/demo.py


